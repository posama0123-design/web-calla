<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>電話 & SMS</title>
    <style>
        * { -webkit-tap-highlight-color: transparent; outline: none; box-sizing: border-box; }
        body { font-family: -apple-system, sans-serif; background: #ffffff; color: #333; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; overflow: hidden; }

        .phone-container { width: 350px; height: 680px; display: flex; flex-direction: column; background: #fff; position: relative; border: 1px solid #ddd; border-radius: 30px; overflow: hidden; }

        /* 上部の入力エリア（ここを自由に入力可能に） */
        .top-input-area { padding: 20px; background: #f9f9f9; border-bottom: 1px solid #eee; }
        .input-label { font-size: 12px; color: #888; margin-bottom: 5px; text-align: left; display: block; }
        
        /* 宛先番号入力（キーボードで打てる） */
        #numberDisplay { 
            width: 100%; border: none; background: transparent; font-size: 28px; 
            font-weight: 300; margin-bottom: 10px; outline: none; padding: 0;
        }
        
        /* メッセージ入力 */
        .sms-input { 
            width: 100%; height: 60px; border: 1px solid #e0e0e0; border-radius: 10px; 
            padding: 10px; font-size: 14px; resize: none; background: #fff;
        }

        /* キーパッド */
        .keypad-container { flex: 1; display: flex; flex-direction: column; justify-content: center; padding: 0 20px; }
        .keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
        .key { 
            width: 70px; height: 70px; background: #f2f2f7; border-radius: 50%; 
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
            cursor: pointer; margin: auto; transition: background 0.1s;
        }
        .key:active { background: #d1d1d6; }
        .key .num { font-size: 28px; line-height: 1; }
        .key .abc { font-size: 9px; font-weight: bold; color: #aaa; }

        /* 下部ボタン */
        .bottom-actions { display: flex; justify-content: center; align-items: center; gap: 20px; padding: 20px; position: relative; }
        .btn-call { width: 70px; height: 70px; background: #28a745; border-radius: 50%; border: none; display: flex; justify-content: center; align-items: center; cursor: pointer; }
        .btn-sms-send { width: 50px; height: 50px; background: #007aff; border-radius: 50%; border: none; display: flex; justify-content: center; align-items: center; cursor: pointer; }
        .btn-backspace { position: absolute; right: 30px; background: none; border: none; color: #999; font-size: 22px; cursor: pointer; }

        /* 通話中用の背景（前回同様） */
        #bg-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: url('https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?fit=crop&w=1200&q=80') center/cover; filter: blur(20px) brightness(0.7); z-index: -1; opacity: 0; transition: 0.8s; }
    </style>
</head>
<body>

<div id="bg-overlay"></div>

<div class="phone-container" id="mainContainer">
    <div class="top-input-area">
        <label class="input-label">宛先:</label>
        <input type="tel" id="numberDisplay" placeholder="番号を入力" maxlength="15">
        
        <label class="input-label">SMSメッセージ:</label>
        <textarea class="sms-input" id="smsText" placeholder="メッセージを入力..."></textarea>
    </div>

    <div class="keypad-container">
        <div class="keypad">
            <div class="key" onclick="press('1')"><div class="num">1</div><div class="abc">&nbsp;</div></div>
            <div class="key" onclick="press('2')"><div class="num">2</div><div class="abc">ABC</div></div>
            <div class="key" onclick="press('3')"><div class="num">3</div><div class="abc">DEF</div></div>
            <div class="key" onclick="press('4')"><div class="num">4</div><div class="abc">GHI</div></div>
            <div class="key" onclick="press('5')"><div class="num">5</div><div class="abc">JKL</div></div>
            <div class="key" onclick="press('6')"><div class="num">6</div><div class="abc">MNO</div></div>
            <div class="key" onclick="press('7')"><div class="num">7</div><div class="abc">PQRS</div></div>
            <div class="key" onclick="press('8')"><div class="num">8</div><div class="abc">TUV</div></div>
            <div class="key" onclick="press('9')"><div class="num">9</div><div class="abc">WXYZ</div></div>
            <div class="key" onclick="press('*')"><div class="num">*</div><div class="abc">&nbsp;</div></div>
            <div class="key" onclick="press('0')"><div class="num">0</div><div class="abc">+</div></div>
            <div class="key" onclick="press('#')"><div class="num">#</div><div class="abc">&nbsp;</div></div>
        </div>
    </div>

    <div class="bottom-actions">
        <button class="btn-sms-send" onclick="sendRealSMS()" title="SMS送信">
            <svg width="24" height="24" fill="white" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
        </button>
        
        <button class="btn-call" onclick="call()" title="発信">
            <svg width="30" height="30" fill="white" viewBox="0 0 24 24"><path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/></svg>
        </button>
        
        <button class="btn-backspace" onclick="backspace()">⌫</button>
    </div>
</div>

<script>
    const display = document.getElementById('numberDisplay');
    const smsText = document.getElementById('smsText');

    // キーパッド押し
    function press(num) {
        display.value += num;
        // 音を鳴らすなどのロジック（省略）
    }

    // 1文字消去
    function backspace() {
        display.value = display.value.slice(0, -1);
    }

    // 本物のSMS送信
    function sendRealSMS() {
        const num = display.value;
        const msg = smsText.value;
        if (!num) { alert("番号を入力してください"); return; }
        window.location.href = `sms:${num}?body=${encodeURIComponent(msg)}`;
    }

    function call() {
        alert(display.value + " に発信します...");
        // ここに以前のWebrtc/Firebaseロジックを統合
    }
</script>
</body>
</html>
