<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>„Ç¨„É©„Ç±„Éº - SO Style Final</title>
    <style>
        :root { --lcd-bg: #c2c7ba; --lcd-text: #333; }
        body { background: #1a1a1a; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; font-family: sans-serif; }
        .phone { width: 320px; background: linear-gradient(#ccc, #999); border-radius: 25px; padding: 20px; border: 4px solid #666; box-shadow: 0 20px 50px rgba(0,0,0,0.8); }
        
        .screen { background: var(--lcd-bg); height: 260px; border: 10px solid #111; display: flex; flex-direction: column; color: var(--lcd-text); position: relative; overflow: hidden; }
        .status-bar { font-size: 11px; display: flex; justify-content: space-between; padding: 2px 5px; border-bottom: 1px solid rgba(0,0,0,0.1); }
        
        .menu-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 10px; flex: 1; }
        .menu-item { text-align: center; font-size: 11px; padding: 2px; border: 1px solid transparent; }
        .menu-item.selected { background-color: #555; color: #fff; }
        .icon { font-size: 20px; display: block; }

        .app-layer { position: absolute; top: 18px; left: 0; width: 100%; height: calc(100% - 18px); background: var(--lcd-bg); display: none; flex-direction: column; padding: 5px; box-sizing: border-box; z-index: 10; }
        #memoDisplay { width: 100%; flex: 1; background: #fff; border: 1px solid #555; font-size: 16px; padding: 4px; box-sizing: border-box; white-space: pre-wrap; word-break: break-all; overflow-y: auto; }

        /* Êìç‰Ωú„Ç≠„Éº„Çª„ÇØ„Ç∑„Éß„É≥ */
        .nav-section { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; margin: 15px 0; align-items: center; }
        .call-btn { background: #e6ffed; border: 2px solid #28a745; color: #28a745; border-radius: 50%; height: 45px; width: 45px; font-weight: bold; cursor: pointer; font-size: 10px; }
        .end-btn { background: #ffeeee; border: 2px solid #dc3545; color: #dc3545; border-radius: 50%; height: 45px; width: 45px; font-weight: bold; cursor: pointer; font-size: 10px; }
        
        .navigation { display: grid; grid-template-areas: ". up ." "left ok right" ". down ."; gap: 2px; }
        .nav-btn { width: 35px; height: 25px; background: #444; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 10px; }
        .ok-btn { grid-area: ok; width: 45px; height: 45px; border-radius: 50%; background: #222; color: white; border: 2px solid #888; cursor: pointer; font-size: 12px; }

        /* „ÉÄ„Ç§„É§„É´„Ç≠„Éº */
        .keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; }
        .keypad button { background: #eee; border: 1px solid #999; padding: 10px; border-radius: 4px; cursor: pointer; display: flex; flex-direction: column; align-items: center; }
        .key-num { font-size: 14px; font-weight: bold; }
        .key-sub { font-size: 8px; color: #666; }
    </style>
</head>
<body>

<div class="phone">
    <div class="screen">
        <div class="status-bar"><span>*Yll</span><span id="clock">12:00</span><span>üîã</span></div>
        <div class="menu-grid" id="homeMenu">
            <div class="menu-item selected" id="menu-0"><span class="icon">üìñ</span>„Ç¢„Éâ„É¨„ÇπÂ∏≥</div>
            <div class="menu-item" id="menu-1"><span class="icon">üìû</span>ÈõªË©±</div>
            <div class="menu-item" id="menu-2"><span class="icon">üìù</span>„É°„É¢</div>
        </div>
        <div class="app-layer" id="appScreen">
            <div id="appTitle" style="font-weight:bold; border-bottom:1px solid #000; font-size:12px;"></div>
            <div id="memoDisplay"></div>
            <div style="font-size: 9px; text-align: center;">[ÁµÇË©±]„Éú„Çø„É≥„Åß‰øùÂ≠òÁµÇ‰∫Ü</div>
        </div>
    </div>

    <div class="nav-section">
        <button class="call-btn" onclick="openApp()">ÈÄöË©±<br>ÈñãÂßã</button>
        <div class="navigation">
            <button class="nav-btn" style="grid-area: up" onclick="moveMenu(-3)">‚ñ≤</button>
            <button class="nav-btn" style="grid-area: left" onclick="moveMenu(-1)">‚óÄ</button>
            <button class="ok-btn" onclick="openApp()">Ê±∫ÂÆö</button>
            <button class="nav-btn" style="grid-area: right" onclick="moveMenu(1)">‚ñ∂</button>
            <button class="nav-btn" style="grid-area: down" onclick="moveMenu(3)">‚ñº</button>
        </div>
        <button class="end-btn" onclick="closeApp()">ÁµÇË©±<br>ÁµÇ‰∫Ü</button>
    </div>

    <div class="keypad">
        <button onclick="press('1')"><span class="key-num">1</span><span class="key-sub">„ÅÇ</span></button>
        <button onclick="press('2')"><span class="key-num">2</span><span class="key-sub">„Åã</span></button>
        <button onclick="press('3')"><span class="key-num">3</span><span class="key-sub">„Åï</span></button>
        <button onclick="press('4')"><span class="key-num">4</span><span class="key-sub">„Åü</span></button>
        <button onclick="press('5')"><span class="key-num">5</span><span class="key-sub">„Å™</span></button>
        <button onclick="press('6')"><span class="key-num">6</span><span class="key-sub">„ÅØ</span></button>
        <button onclick="press('7')"><span class="key-num">7</span><span class="key-sub">„Åæ</span></button>
        <button onclick="press('8')"><span class="key-num">8</span><span class="key-sub">„ÇÑ</span></button>
        <button onclick="press('9')"><span class="key-num">9</span><span class="key-sub">„Çâ</span></button>
        <button onclick="toggleSize()"><span class="key-num">Ôºä</span><span class="key-sub">Â§ßÂ∞è</span></button>
        <button onclick="press('0')"><span class="key-num">0</span><span class="key-sub">„Çè</span></button>
        <button onclick="clearChar()"><span class="key-num">ÔºÉ</span><span class="key-sub">Ê∂àÂéª</span></button>
    </div>
</div>

<script>
    let selectedIndex = 0;
    let isAppOpen = false;
    let currentText = "";
    let lastKey = null;
    let keyIdx = 0;
    let timer = null;

    const mapping = {
        '1':['„ÅÇ','„ÅÑ','„ÅÜ','„Åà','„Åä'],'2':['„Åã','„Åç','„Åè','„Åë','„Åì'],'3':['„Åï','„Åó','„Åô','„Åõ','„Åù'],
        '4':['„Åü','„Å°','„Å§','„Å¶','„Å®'],'5':['„Å™','„Å´','„Å¨','„Å≠','„ÅÆ'],'6':['„ÅØ','„Å≤','„Åµ','„Å∏','„Åª'],
        '7':['„Åæ','„Åø','„ÇÄ','„ÇÅ','„ÇÇ'],'8':['„ÇÑ','„ÇÜ','„Çà'],'9':['„Çâ','„Çä','„Çã','„Çå','„Çç'],'0':['„Çè','„Çí','„Çì','„Éº']
    };
    const smalls = {'„ÅÇ':'„ÅÅ','„ÅÑ':'„ÅÉ','„ÅÜ':'„ÅÖ','„Åà':'„Åá','„Åä':'„Åâ','„Å§':'„Å£','„ÇÑ':'„ÇÉ','„ÇÜ':'„ÇÖ','„Çà':'„Çá'};

    function moveMenu(d) {
        if(isAppOpen) return;
        document.querySelectorAll('.menu-item')[selectedIndex].classList.remove('selected');
        selectedIndex = (selectedIndex + d + 3) % 3;
        document.querySelectorAll('.menu-item')[selectedIndex].classList.add('selected');
    }

    function openApp() {
        isAppOpen = true;
        document.getElementById('appScreen').style.display = 'flex';
        const title = document.getElementById('appTitle');
        const display = document.getElementById('memoDisplay');
        
        if(selectedIndex === 2) {
            title.innerText = "„É°„É¢Â∏≥";
            currentText = localStorage.getItem('keita_memo') || "";
            display.innerText = currentText;
        } else if(selectedIndex === 0) {
            title.innerText = "„Ç¢„Éâ„É¨„ÇπÂ∏≥";
            display.innerText = "ÔºàÁôªÈå≤„Å™„ÅóÔºâ";
        } else {
            title.innerText = "ÈõªË©±";
            display.innerText = "";
        }
    }

    function closeApp() {
        if(selectedIndex === 2 && isAppOpen) {
            localStorage.setItem('keita_memo', currentText);
        }
        isAppOpen = false;
        document.getElementById('appScreen').style.display = 'none';
        currentText = "";
    }

    function press(k) {
        if(!isAppOpen || selectedIndex !== 2) return;
        if(lastKey === k) {
            keyIdx = (keyIdx + 1) % mapping[k].length;
            currentText = currentText.slice(0,-1) + mapping[k][keyIdx];
        } else {
            keyIdx = 0;
            currentText += mapping[k][keyIdx];
        }
        lastKey = k;
        document.getElementById('memoDisplay').innerText = currentText;
        clearTimeout(timer);
        timer = setTimeout(()=> { lastKey = null; }, 800);
    }

    function toggleSize() {
        if(!isAppOpen || !currentText) return;
        let last = currentText.slice(-1);
        for(let key in smalls) {
            if(last === key) { last = smalls[key]; break; }
            if(last === smalls[key]) { last = key; break; }
        }
        currentText = currentText.slice(0,-1) + last;
        document.getElementById('memoDisplay').innerText = currentText;
    }

    function clearChar() {
        currentText = currentText.slice(0, -1);
        document.getElementById('memoDisplay').innerText = currentText;
    }

    function updateClock() {
        const n = new Date();
        document.getElementById('clock').innerText = n.getHours().toString().padStart(2,'0')+":"+n.getMinutes().toString().padStart(2,'0');
    }
    setInterval(updateClock, 1000); updateClock();
</script>
</body>
</html>
